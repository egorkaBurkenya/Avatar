# –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∫–ª–∞—Å—Å–æ–≤ `Indicator`, `Organ` –∏ `Avatar` –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∑–¥–æ—Ä–æ–≤—å—è —á–µ–ª–æ–≤–µ–∫–∞. 
* –ö–ª–∞—Å—Å `Indicator` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –∑–¥–æ—Ä–æ–≤—å—è, 
* –∫–ª–∞—Å—Å `Organ` - –æ—Ä–≥–∞–Ω, 
* –∞ –∫–ª–∞—Å—Å `Avatar` - —á–µ–ª–æ–≤–µ–∫–∞.

## –ö–ª–∞—Å—Å Indicator

### –ê—Ç—Ä–∏–±—É—Ç—ã
- `name` - —Å—Ç—Ä–æ–∫–∞, –∏–º—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –∑–¥–æ—Ä–æ–≤—å—è
- `data_type` - —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –∑–¥–æ—Ä–æ–≤—å—è
- `value` - –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –∑–¥–æ—Ä–æ–≤—å—è

### –ú–µ—Ç–æ–¥—ã
- `__init__(self, name, data_type, value=None)` - –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞
- –ù–µ—Ç –¥—Ä—É–≥–∏—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤

## –ö–ª–∞—Å—Å Organ

### –ê—Ç—Ä–∏–±—É—Ç—ã
- `name` - —Å—Ç—Ä–æ–∫–∞, –∏–º—è –æ—Ä–≥–∞–Ω–∞
- `indicators` - —Å–ª–æ–≤–∞—Ä—å –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∑–¥–æ—Ä–æ–≤—å—è –æ—Ä–≥–∞–Ω–∞

### –ú–µ—Ç–æ–¥—ã
- `__init__(self, name)` - –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞
- `add_indicator(self, indicator)` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –∑–¥–æ—Ä–æ–≤—å—è –≤ –æ—Ä–≥–∞–Ω

## –ö–ª–∞—Å—Å Avatar

### –ê—Ç—Ä–∏–±—É—Ç—ã
- `organs` - —Å–ª–æ–≤–∞—Ä—å –æ—Ä–≥–∞–Ω–æ–≤ —á–µ–ª–æ–≤–µ–∫–∞
- `formulas` - —Å–ø–∏—Å–æ–∫ —Ñ–æ—Ä–º—É–ª —Å–≤—è–∑—ã–≤–∞—é—â–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∑–¥–æ—Ä–æ–≤—å—è

### –ú–µ—Ç–æ–¥—ã
- `__init__(self, schema=None, case_data=None)` - –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞
- `add_organ(self, organ)` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∞ –≤ —á–µ–ª–æ–≤–µ–∫–∞
- `from_schema(self, schema)` - —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ–ª–æ–≤–µ–∫–∞ –∏–∑ —Å—Ö–µ–º—ã
- `from_case_data(self, case_data)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∑–¥–æ—Ä–æ–≤—å—è –∏–∑ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `apply_formulas(self, changed_organ, changed_indicator)` - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ–æ—Ä–º—É–ª –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∑–¥–æ—Ä–æ–≤—å—è
- `update_indicator(self, organ_name, indicator_name, value, apply_formulas=True)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –∑–¥–æ—Ä–æ–≤—å—è –æ—Ä–≥–∞–Ω–∞
- `from_json_string(self, schema_json, case_data_json)` - —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ–ª–æ–≤–µ–∫–∞ –∏–∑ JSON-—Å—Ç—Ä–æ–∫–∏ —Å —Å—Ö–µ–º–æ–π –∏ –¥–∞–Ω–Ω—ã–º–∏

## –§–æ—Ä–º—É–ª—ã:
–§–æ—Ä–º—É–ª—ã - —ç—Ç–æ –ø—Ä–∞–≤–∏–ª–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç –≤–∑–∞–∏–º–æ—Å–≤—è–∑—å –º–µ–∂–¥—É –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ –≤–Ω—É—Ç—Ä–∏ –æ—Ä–≥–∞–Ω–∏–∑–º–∞ —á–µ–ª–æ–≤–µ–∫–∞. –û–Ω–∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥—Ä—É–≥–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.

–ü—Ä–∏–Ω—Ü–∏–ø –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ñ–æ—Ä–º—É–ª —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã —É–∫–∞–∑–∞—Ç—å:

* –¢—Ä–∏–≥–≥–µ—Ä–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å - –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ä–∞—Å—á–µ—Ç —Ñ–æ—Ä–º—É–ª—ã.
* –¶–µ–ª–µ–≤–æ–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å - –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–∞—Å—á–µ—Ç–∞ —Ñ–æ—Ä–º—É–ª—ã.
* –í—ã—Ä–∞–∂–µ–Ω–∏–µ - –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ —è–∑—ã–∫–µ Python, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –Ω–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è.

–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å "—Å–∞—Ö–∞—Ä –≤ –∫—Ä–æ–≤–∏" –∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å "–∏–Ω—Å—É–ª–∏–Ω", —Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Ñ–æ—Ä–º—É–ª—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è "—Å–∞—Ö–∞—Ä –≤ –∫—Ä–æ–≤–∏" –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è "–∏–Ω—Å—É–ª–∏–Ω".

### –ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º—É–ª—ã:
```json
{
    "trigger": ("pancreas", "insulin"),
    "target": ("blood", "glucose"),
    "expression": "max(80, min(120, value + (value - trigger_value) * 0.05))"
}

```
**–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ:**
* –¢—Ä–∏–≥–≥–µ—Ä–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å - "–∏–Ω—Å—É–ª–∏–Ω", –Ω–∞—Ö–æ–¥—è—â–∏–π—Å—è –≤ –ø–æ–¥–∂–µ–ª—É–¥–æ—á–Ω–æ–π –∂–µ–ª–µ–∑–µ ("pancreas").
* –¶–µ–ª–µ–≤–æ–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å - "—Å–∞—Ö–∞—Ä –≤ –∫—Ä–æ–≤–∏", –Ω–∞—Ö–æ–¥—è—â–∏–π—Å—è –≤ –∫—Ä–æ–≤–∏ ("blood").
* –í—ã—Ä–∞–∂–µ–Ω–∏–µ - "max(80, min(120, value + (value - trigger_value) * 0.05))", –∫–æ—Ç–æ—Ä–æ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –Ω–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è "—Å–∞—Ö–∞—Ä –≤ –∫—Ä–æ–≤–∏" –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è "–∏–Ω—Å—É–ª–∏–Ω".

**–í—ã—Ä–∞–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
* "value" - —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è.
* "trigger_value" - —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–Ω–æ–≥–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è.

–§–æ—Ä–º—É–ª—ã –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –∫–ª–∞—Å—Å Avatar —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ from_schema. –ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ —Ñ–æ—Ä–º—É–ª—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã, –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º –ø—Ä–∏ –∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ apply_formulas.

–§–æ—Ä–º—É–ª—ã - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã –æ—Ä–≥–∞–Ω–∏–∑–º–∞ —á–µ–ª–æ–≤–µ–∫–∞ –∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π.

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
from Avatar import Avatar

def create_schema():
    return {
        "organs": {
            "heart": {"indicators": {"rate": {"data_type": "float"}, "ecg": {"data_type": "list"}}},
            "lungs": {"indicators": {"capacity": {"data_type": "float"}}},
            "brain": {"indicators": {"size": {"data_type": "float"}}},
        },
        "formulas": [
            {"trigger": ("heart", "rate"), "target": ("lungs", "capacity"), "expression": "value + trigger_value"},
            {"trigger": ("heart", "rate"), "target": ("heart", "ecg"), "expression": "[*value, 1]"},
            {"trigger": ("heart", "rate"), "target": ("brain", "size"), "expression": "value * 10"},
            {"trigger": ("lungs", "capacity"), "target": ("brain", "size"), "expression": "value + trigger_value"},
        ],
    }


def create_case_data():
    return {
        "organs": {
            "heart": {"indicators": {"rate": 60.0, "ecg": [1, 2, 3]}},
            "lungs": {"indicators": {"capacity": 6.0}},
            "brain": {"indicators": {"size": 100.0}},
        }
    }

if __name__ == "__main__":
    schema = create_schema()
    case_data = create_case_data()

    person = Avatar(schema, case_data)

    print("\nInitial values:")
    print("‚ù§Ô∏è Heart rate:", person.organs["heart"].indicators["rate"].value)
    print("„ÄΩÔ∏è Heart ecg:", person.organs["heart"].indicators["ecg"].value)
    print("ü´Å Lung capacity:", person.organs["lungs"].indicators["capacity"].value)
    print("üß† Brain size:", person.organs["brain"].indicators["size"].value)

    person.update_indicator("heart", "rate", 70.0)

    print("\nUpdated values:")
    print("‚ù§Ô∏è Heart rate:", person.organs["heart"].indicators["rate"].value)
    print("„ÄΩÔ∏è Heart ecg:", person.organs["heart"].indicators["ecg"].value)
    print("ü´Å Lung capacity:", person.organs["lungs"].indicators["capacity"].value)
    print("üß† Brain size:", person.organs["brain"].indicators["size"].value)
```
### –û—Ç–≤–µ—Ç:
```bash
Initial values:
‚ù§Ô∏è Heart rate: 60.0
„ÄΩÔ∏è Heart ecg: [1, 2, 3]
ü´Å Lung capacity: 6.0
üß† Brain size: 100.0

Updated values:
‚ù§Ô∏è Heart rate: 70.0
„ÄΩÔ∏è Heart ecg: [1, 2, 3, 1]
ü´Å Lung capacity: 76.0
üß† Brain size: 1076.0
```
### –ü–æ—è—Å–Ω–µ–Ω–∏—è:

`–§–æ—Ä–º—É–ª–∞ ‚Ññ1` —Å–≤—è–∑—ã–≤–∞–µ—Ç –ß–°–° –∏ —ë–º–∫–æ—Å—Ç—å –ª—ë–≥–∫–∏—Ö: —ë–º–∫–æ—Å—Ç—å –ª—ë–≥–∫–∏—Ö —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ä–∞–≤–Ω–æ–π —Å—É–º–º–µ –µ—ë –∏ –ß–°–°. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ, –ß–°–° —É–≤–µ–ª–∏—á–∏–ª–∞—Å—å —Å 60 –¥–æ 70, –ø–æ—ç—Ç–æ–º—É —ë–º–∫–æ—Å—Ç—å –ª—ë–≥–∫–∏—Ö —É–≤–µ–ª–∏—á–∏–ª–∞—Å—å –Ω–∞ 10 –∏ —Å—Ç–∞–ª–∞ —Ä–∞–≤–Ω–∞ 76.

`–§–æ—Ä–º—É–ª–∞ ‚Ññ2` —Å–≤—è–∑—ã–≤–∞–µ—Ç –ß–°–° –∏ –≠–ö–ì —Å–µ—Ä–¥—Ü–∞: –≠–ö–ì —Å–µ—Ä–¥—Ü–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–ø–∏—Å–∫–æ–º –∏–∑ —Å—Ç–∞—Ä—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–ª—é—Å –µ–¥–∏–Ω–∏—Ü–∞ –≤ –∫–æ–Ω—Ü–µ. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ, –ß–°–° —É–≤–µ–ª–∏—á–∏–ª–∞—Å—å –Ω–∞ 10, –ø–æ—ç—Ç–æ–º—É –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞ –±—ã–ª–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –µ–¥–∏–Ω–∏—Ü–∞.

`–§–æ—Ä–º—É–ª–∞ ‚Ññ3` —Å–≤—è–∑—ã–≤–∞–µ—Ç –ß–°–° –∏ —Ä–∞–∑–º–µ—Ä –º–æ–∑–≥–∞: —Ä–∞–∑–º–µ—Ä –º–æ–∑–≥–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ä–∞–≤–µ–Ω —Å—Ç–∞—Ä–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é, —É–º–Ω–æ–∂–µ–Ω–Ω–æ–º—É –Ω–∞ 10. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ, –ß–°–° —É–≤–µ–ª–∏—á–∏–ª–∞—Å—å —Å 60 –¥–æ 70, –ø–æ—ç—Ç–æ–º—É —Ä–∞–∑–º–µ—Ä –º–æ–∑–≥–∞ —É–≤–µ–ª–∏—á–∏–ª—Å—è —Å 100 –¥–æ 1000 + 70*10 = 1070.

`–§–æ—Ä–º—É–ª–∞ ‚Ññ4` —Å–≤—è–∑—ã–≤–∞–µ—Ç —ë–º–∫–æ—Å—Ç—å –ª—ë–≥–∫–∏—Ö –∏ —Ä–∞–∑–º–µ—Ä –º–æ–∑–≥–∞: —Ä–∞–∑–º–µ—Ä –º–æ–∑–≥–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ä–∞–≤–µ–Ω —Å—É–º–º–µ —Å—Ç–∞—Ä–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –º–æ–∑–≥–∞ –∏ —ë–º–∫–æ—Å—Ç–∏ –ª—ë–≥–∫–∏—Ö. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ, —ë–º–∫–æ—Å—Ç—å –ª—ë–≥–∫–∏—Ö —É–≤–µ–ª–∏—á–∏–ª–∞—Å—å —Å 6 –¥–æ 76, –ø–æ—ç—Ç–æ–º—É —Ä–∞–∑–º–µ—Ä –º–æ–∑–≥–∞ —É–≤–µ–ª–∏—á–∏–ª—Å—è —Å 1070 –¥–æ 1070 + 76 = 1076.